// Generated by Copilot
/**
 * Enhanced mock for Solana wallet adapter
 * This provides a comprehensive mock for testing wallet-related components
 */

import { WalletReadyState } from '@solana/wallet-adapter-base';

const MOCK_PUBLIC_KEY = '8YvzTvb4YwQMKNNe1zrQWhS6KSgGSdCgE4nvp8p3Kh8N';

/**
 * Creates a mock wallet with configurable state and behavior
 */
export function createMockWallet({
  connected = false,
  publicKey = MOCK_PUBLIC_KEY,
  readyState = WalletReadyState.Installed,
  name = 'Mock Wallet',
  connecting = false,
  disconnecting = false,
  hasAcceptedDeeplinking = true,
  supportedTransactionVersions = new Set(['legacy', '0']),
  autoConnect = false,
  onConnect = () => {},
  onDisconnect = () => {},
  onError = () => {},
} = {}) {
  const mockPublicKey = publicKey
    ? { toBase58: () => publicKey, toBytes: () => new Uint8Array(32) }
    : null;

  return {
    publicKey: mockPublicKey,
    isConnected: connected,
    readyState,
    name,
    connecting,
    disconnecting,
    hasAcceptedDeeplinking,
    supportedTransactionVersions,
    autoConnect,
    connect: jest.fn().mockImplementation(async () => {
      onConnect();
      return Promise.resolve();
    }),
    disconnect: jest.fn().mockImplementation(async () => {
      onDisconnect();
      return Promise.resolve();
    }),
    sendTransaction: jest.fn().mockImplementation(async () => {
      return 'mock-transaction-signature';
    }),
    signTransaction: jest.fn().mockImplementation(async transaction => {
      return transaction;
    }),
    signAllTransactions: jest.fn().mockImplementation(async transactions => {
      return transactions;
    }),
    signMessage: jest.fn().mockImplementation(async message => {
      return message;
    }),
  };
}

/**
 * Creates a mock wallet adapter context
 */
export function createMockWalletContext(walletOverrides = {}) {
  const mockWallet = createMockWallet(walletOverrides);

  return {
    wallets: [mockWallet],
    wallet: mockWallet,
    publicKey: mockWallet.publicKey,
    connected: mockWallet.isConnected,
    connecting: mockWallet.connecting,
    disconnecting: mockWallet.disconnecting,
    autoConnect: mockWallet.autoConnect,
    select: jest.fn(),
    connect: mockWallet.connect,
    disconnect: mockWallet.disconnect,
    sendTransaction: mockWallet.sendTransaction,
    signTransaction: mockWallet.signTransaction,
    signAllTransactions: mockWallet.signAllTransactions,
    signMessage: mockWallet.signMessage,
  };
}

/**
 * Jest mock for @solana/wallet-adapter-react
 */
const walletAdapterReactMock = {
  useWallet: jest.fn().mockImplementation(() => createMockWalletContext()),
  WalletProvider: ({ children }) => children,
  useConnection: jest.fn().mockImplementation(() => ({
    connection: {
      getBalance: jest.fn().mockResolvedValue(1000000000),
      getAccountInfo: jest.fn().mockResolvedValue({ lamports: 1000000000 }),
      getRecentBlockhash: jest.fn().mockResolvedValue({
        blockhash: 'mock-blockhash',
        lastValidBlockHeight: 100000,
      }),
    },
  })),
};

module.exports = walletAdapterReactMock;
